id: 55084
name: codexatlas
environments:
  production:
    memory: 1024
    cli-memory: 512
    queue-memory: 512
    concurrency: 50
    queue-concurrency: 20
    timeout: 50
    queue-timeout: 300
    storage: codex-atlas
    database: codex-atlas-production
    warm: 10
    runtime: "php-8.2:al2"
    network: codex-atlas-production
    domain:
      - "*.codexatlas.app"
      - automaticdocs.app
    build:
      - "COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev"
      - "php artisan event:cache"
      - "npm ci && npm run build && rm -rf node_modules"
    deploy:
      - "php artisan migrate --force"
    firewall:
      rate-limit: 1000
      bot-control:
        - CategorySearchEngine
        - CategorySocialMedia
        - CategoryScrapingFramework
    queues:
      - codex-production
  staging:
    memory: 512
    cli-memory: 512
    queue-memory: 512
    concurrency: 10
    queue-concurrency: 10
    queue-timeout: 300
    storage: codex-atlas-staging
    database: codex-atlas-staging
    database-proxy: true
    runtime: "php-8.2:al2"
    network: codex-atlas-staging
    domain: "*.codexatlas-staging.dev"
    build:
      - "COMPOSER_MIRROR_PATH_REPOS=1 composer install"
      - "php artisan event:cache"
      - "npm ci && npm run build && rm -rf node_modules"
    deploy:
      - "php artisan migrate --force"
    firewall:
      rate-limit: 1000
    queues:
      - codex-staging
